steps:
  PY_ORDER_HEADER1-08496a54-da52-469c-96de-abf1daa70404:
    operation:
      config:
        dfcmd: |-
          import snowflake.snowpark.functions as F
          import snowflake.snowpark.types as T
          from snowflake.snowpark import Window
          window_by_location_all_days = (
              Window.partition_by("LOCATION_ID", "SHIFT_ID")
              .order_by("ORDER_TS")
              .rows_between(Window.UNBOUNDED_PRECEDING, Window.CURRENT_ROW - 1)
          )
          snowpark_df = df_raw.with_column(
              "avg_location_shift_sales", 
              F.avg("ORDER_TOTAL").over(window_by_location_all_days)
          )

          df_final = snowpark_df
        pyLib: import snowflake.snowpark as snowpark
        writeMode: overwrite
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: DW
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 79fa01c2-2ea3-4c4b-8fd6-b51b14c5d409
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: ORDER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 9cf1bc31-56a4-4da2-8a68-77de6c740d79
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 1c19f2b5-e142-47b1-860b-e6bd8c6d0577
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: TRUCK_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8d0a557e-ac81-4d9d-abe6-18d755997e5a
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 01fe4f6c-110c-4945-be58-2b3226ac7051
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: FLOAT
            description: ""
            hashDetails: null
            name: LOCATION_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 75059027-020d-41a1-87a0-a8b000857749
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 7547866d-072b-40b1-861e-b36ee70a5487
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: CUSTOMER_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 560983a6-668e-40ab-966c-7d3eb11f8e9a
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 189f0987-e761-4eba-b7d9-46ef8f9aa4ec
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: DISCOUNT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d403c2b1-0e04-49f8-9f26-2802656df005
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 6279e7f9-5208-465e-9865-c40b60946c3a
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: NUMBER(38,0)
            description: ""
            hashDetails: null
            name: SHIFT_ID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 334d2c84-eed1-4aa6-915e-afa516de9085
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 7ebab8d5-a8d4-4ddd-838f-da8f6743c478
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: TIME(9)
            description: ""
            hashDetails: null
            name: SHIFT_START_TIME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f1d86c4a-5b98-42b7-966a-76c84e1ad52f
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: d8a77288-7044-41d4-9a0b-85931fff8fda
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: TIME(9)
            description: ""
            hashDetails: null
            name: SHIFT_END_TIME
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2fe37f89-78e2-42de-9da9-b5ce7826b9c3
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 42039848-edbe-44e4-b4be-489cd2f66f5f
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: ORDER_CHANNEL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 17aa3f48-901e-4163-b51b-82da1785c799
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 147fd7fc-2079-4550-881f-4d9bbfb0e1ce
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: TIMESTAMP_NTZ(9)
            description: ""
            hashDetails: null
            name: ORDER_TS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 23378cda-3fbb-4123-9408-55cfcff2db8f
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: b035daa1-76a2-4314-8533-312c046d4065
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: SERVED_TS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a8ba06ea-db9b-4e25-98ec-9c7adbe26088
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: d2bf07f2-a69c-45f5-8e5c-538e9fe22382
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: ORDER_CURRENCY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 93430e8a-c3ae-4af8-a2ea-6de8097d4c4c
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: cd8606d5-6307-475a-9416-55b9e3f6fff4
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: NUMBER(38,4)
            description: ""
            hashDetails: null
            name: ORDER_AMOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e578092e-cf79-483d-9d3d-3ae035b85418
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: d8730db1-b1b4-4adc-8649-007b55e04d4c
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: ORDER_TAX_AMOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 182fd573-f70f-407e-88b7-76a761b43be5
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: ea7289d5-ea6f-46f9-aa56-0a06aaee313e
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: VARCHAR(16777216)
            description: ""
            hashDetails: null
            name: ORDER_DISCOUNT_AMOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 96ed72b0-85f1-4937-91d7-ba1223de3f1d
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
          - columnReference:
              columnCounter: 30ab27bd-7401-4504-b553-f3d1d4a1adc3
              stepCounter: 08496a54-da52-469c-96de-abf1daa70404
            dataType: NUMBER(38,4)
            description: ""
            hashDetails: null
            name: ORDER_TOTAL
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b85bb06d-49c9-43a8-bcab-184661504ecb
                    stepCounter: 8ecda618-db51-4eeb-b2a6-5d0cb6db372b
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases: {}
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: DW
                nodeName: PY_ORDER_HEADER
            join:
              joinCondition: FROM {{ ref('DW', 'PY_ORDER_HEADER') }} "PY_ORDER_HEADER"
            name: PY_ORDER_HEADER1
            noLinkRefs: []
      name: PY_ORDER_HEADER1
      overrideSQL: false
      schema: ""
      sqlType: "5"
      type: sql
    stepCounter: 08496a54-da52-469c-96de-abf1daa70404
